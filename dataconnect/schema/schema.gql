type Hotel @table {
  name: String!
  address: String!
  propertyId: String!
  phoneNumber: String
  email: String
  description: String
  demoMode: Boolean @default(value: false)
  maintenanceEmail: String
}

type Room @table {
  hotel: Hotel!
  roomNumber: String!
  roomType: String!
  status: String!
  capacity: Int
  dailyRate: Float
  description: String
}

type Guest @table {
  hotel: Hotel!
  name: String!
  email: String!
  phoneNumber: String
  address: String
  notes: String
  history: Any # JSON array of Stay objects
}

type Booking @table {
  hotel: Hotel!
  guest: Guest!
  room: Room
  checkInDate: Timestamp!
  checkOutDate: Timestamp!
  checkOutActual: Timestamp
  bookingStatus: String! # Active, Completed, Cancelled, Reserved
  specialRequests: String
  numberOfGuests: Int
  ratePerNight: Float
  totalPaid: Float
  isIndefinite: Boolean @default(value: false)
}

type Staff @table {
  hotel: Hotel!
  firstName: String!
  lastName: String!
  role: String!
  username: String!
  passwordHash: String!
  email: String
  phoneNumber: String
  department: String
  pin: String
  status: String! # Active, Inactive
  currentStatus: String! # Clocked Out, Clocked In, On Break
}

type Log @table {
  hotel: Hotel!
  timestamp: Timestamp! @default(expr: "request.time")
  action: String!
  user: String!
  category: String!
  details: String!
}

type FinancialDocument @table {
  hotel: Hotel!
  docType: String! # Invoice, Receipt
  number: String!
  date: Timestamp!
  booking: Booking
  guest: Guest
  guestName: String!
  totalAmount: Float!
  notes: String
  summary: String
  items: Any # JSON array of items
}

type TimeLog @table {
  hotel: Hotel!
  staff: Staff!
  date: Date!
  startTime: Timestamp!
  endTime: Timestamp
  breaks: Any # JSON array of TimeBreak objects
  totalHours: Float
  status: String! # Open, Closed
}

type Shift @table {
  hotel: Hotel!
  staff: Staff!
  date: Date!
  startTime: String! # HH:mm
  endTime: String! # HH:mm
  shiftType: String! # Regular, Overtime, TimeOff
  notes: String
}

type StoredDocument @table {
  hotel: Hotel!
  title: String!
  category: String!
  uploadedBy: String!
  uploadedAt: Timestamp! @default(expr: "request.time")
  fileType: String!
  data: String! # Base64
  tags: Any # JSON array of strings
  guest: Guest
  summary: String
}

type MaintenanceRequest @table {
  hotel: Hotel!
  room: Room!
  description: String!
  priority: String! # Low, Medium, High, Emergency
  status: String! # Pending, In Progress, Completed
  reportedBy: String!
  reportedAt: Timestamp! @default(expr: "request.time")
  completedAt: Timestamp
  cost: Float
  notes: String
}

type User @table {
  id: String!
  email: String!
  role: String!
}

type UserHotel @table(key: ["user", "hotel"]) {
  user: User!
  hotel: Hotel!
}

type HousekeepingTask @table {
  hotel: Hotel!
  room: Room!
  assignedTo: Staff
  status: String! # Pending, In Progress, Completed
  priority: String! # Routine, Urgent
  notes: String
  scheduledFor: Timestamp!
  completedAt: Timestamp
}

type InventoryItem @table {
  hotel: Hotel!
  name: String!
  category: String! # Toiletries, Linens, Food, Cleaning
  quantity: Int!
  minQuantity: Int!
  unit: String! # pieces, liters, kg
}

type Amenity @table {
  hotel: Hotel!
  name: String!
  description: String
  location: String
  status: String! # Open, Closed, Maintenance
}

type Department @table {
  hotel: Hotel!
  name: String!
  head: Staff
}

type AiUsage @table {
  hotel: Hotel!
  userId: String!
  timestamp: Timestamp! @default(expr: "request.time")
  feature: String! # e.g., "Daily Report", "Maintenance Alert"
  model: String! # e.g., "gemini-2.0-flash"
  promptTokens: Int
  responseTokens: Int
  totalTokens: Int
}
